{{define "code/show"}}

<!doctype html>
<html lang="en">

<head>
  {{template "head" .}}
</head>

<body class="bg-light">
  {{template "navbar" .}}

  <main role="main" class="container">
    {{template "flash" .}}

    <h1>Verification code status</h1>
    <p>
      Status of a verification code previously shared with your patient.
    </p>

    <div class="card mb-3">
      <div class="card-header">
        Code status
      </div>
      <div class="list-group-item">
        <h5 class="mb-1">UUID</h5>
        <p class="mb-1 text-monospace">{{.code.UUID}}</p>
      </div>
      <div class="list-group-item">
        <h5 class="mb-1">{{.code.IssuerType}}</h5>
        <p class="mb-1">{{.code.Issuer}}</p>
      </div>
      <div class="list-group-item">
        <h5 class="mb-1">Test type</h5>
        <p class="mb-1">{{.code.TestType}}</p>
      </div>
      <div class="list-group-item">
        <h5 class="mb-1">Status</h5>
        <p class="mb-1">{{.code.Status}}</p>
      </div>
      <div class="list-group-item">
        <h5 class="mb-1">Expiry</h5>
        <span id="code-expires-at" class="sm text-danger"></span>
      </div>
      <form id="expireForm" action="/expire" method="POST">
        <input type="hidden" name="uuid" value="{{.code.UUID}}" />
        <button type="submit" id="invalidate" class="btn btn-danger btn-sm">Invalidate code now</button>
      </form>
    </div>

    <div>
      <a href="/code/status">&larr; Enter another code</a>
    </div>
  </main>

  {{template "scripts" .}}
  {{template "codescripts" .}}

  <script type="text/javascript">
    let $codeExpiresAt;
    let expires = {{ .code.Expires }};

    $(function() {
      $codeExpiresAt = $('#code-expires-at');
      // Start countdown
      countdown($codeExpiresAt, expires);
    });
  </script>
</body>

</html>
{{end}}
